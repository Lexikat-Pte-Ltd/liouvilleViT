/media/cc/2T/liouvilleViT/train_masked_blocks.py:120: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()  # Initialize GradScaler for mixed precision

--- Epoch 1/100 ---
Batch shape: torch.Size([1, 10, 2, 50, 50])
/media/cc/2T/liouvilleViT/train_masked_blocks.py:131: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
MaskedBlockViT.forward called
  x_blocks shape: torch.Size([1, 10, 2, 50, 50])
  CNNBlockEncoder input shape: torch.Size([10, 2, 50, 50])
  CNNBlockEncoder output shape: torch.Size([10, 128])
  x_emb shape after encoder and view: torch.Size([1, 10, 128])
  x_emb shape after adding pos_embed_2d: torch.Size([1, 10, 128])
  x_masked shape: torch.Size([1, 7, 128])
  ids_keep shape: torch.Size([1, 7])
  ids_mask shape: torch.Size([1, 3])
  ids_restore shape: torch.Size([1, 10])
  encoded shape after transformer: torch.Size([1, 7, 128])
  decoder_input shape: torch.Size([1, 10, 128])
  linear_decoded shape: torch.Size([1, 10, 10816])
  conv_input shape: torch.Size([10, 64, 13, 13])
  pred_flat_conv shape: torch.Size([10, 2, 52, 52])
  Cropping pred_flat_conv from torch.Size([10, 2, 52, 52]) to (2, 50, 50)
x_blocks.shape: torch.Size([1, 10, 50, 50, 2])
Traceback (most recent call last):
  File "/media/cc/2T/liouvilleViT/train_masked_blocks.py", line 181, in <module>
    run_training()
  File "/media/cc/2T/liouvilleViT/train_masked_blocks.py", line 141, in run_training
    loss = loss_fn(pred[mask], target[mask])
IndexError: The shape of the mask [10000] at index 0 does not match the shape of the indexed tensor [10, 50, 50, 2] at index 0
